<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ¯”ä¾‹å·¥å…·</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Micro+5&display=swap" rel="stylesheet">

    <style> :root {
    --primary: #3498db;
    --panel-bg: #ffffff;
    --accent: #e67e22;
    --ruler-color: #555;
    /* å®šç¾©æ–°çš„æ¯”ä¾‹ï¼š1cm = 3.5px (200cm = 700px) */
    --scale-factor: 3.5;
 }
 body {
    font-family: "Micro 5", "DotGothic16", sans-serif;
    font-size: 16px;
    font-size-adjust: 0.5;
    background: #f0f3f5;
    display: flex;
    margin: 0;
    padding: 0;
    height: 100vh;
    overflow: hidden;
 }
 /* å·¦å´æ§åˆ¶é¢æ¿ */

 .sidebar {
    position: absolute;
    height: auto;
    width: 250px;
    left: 15px;
    top: 15px;
    max-height: 90%;
    background: #DCD;
    padding: 15px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    z-index: 100;
 }
 .char-tabs {
    display: flex;
    gap: 5px;
    margin-bottom: 15px;
    overflow-x: auto;
    padding-bottom: 5px;
 }
 .tab {
    padding: 8px 12px;
    background: #eee;
    border-radius: 5px;
    cursor: pointer;
    white-space: nowrap;
 }
 .tab.active {
    background: var(--primary);
    color: white;
 }
 button {
    font-family: "Micro 5", "DotGothic16";
    padding: 6px 12px;
    cursor: pointer;
    border: none;
    border-radius: 4px;
    background: #95a5a6;
    color: white;
 }
 button.a {
    background: #2ecc71;
 }
 button.d {
    background: #e74c3c;
 }
 button.r {
    background: #e74c3c;
 }
 button:hover {
    background: #fff;
 }
 /* å³å´ç¹ªåœ–å€ */

 .main-view {
    width: 100vw;
    height: 100vh;
    background: #d1d8e0;
    background-image: linear-gradient(#ffffff 1px, transparent 1px), linear-gradient(90deg, #ffffff 1px, transparent 1px);
    background-size: 40px 40px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    padding-bottom: 60px;
    position: relative;
    z-index: 1;
 }
 .stage {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: flex-end;
 }
 /* æ¨™å°ºå®¹å™¨ (200cm åŸºæº–) */

 .ruler-container {
    position: absolute;
    right: 30px;
    bottom: 60px;
    width: 100%;
    height: 700px;
    /* 200cm * 3.5 */
    transform-origin: bottom right;
    pointer-events: none;
    z-index: 5;
 }
/*
 .ruler-container::after {
    border-bottom: 1px solid red;
    content: '';
    position: absolute;
    right: 80px;
    width: 100%;
    height: 1px;
    bottom: 0px;
    background: red;
 }
*/

.horiz { 
  position: absolute;
  bottom: 60px;
 right: 80px;
  width: 100%;       /* å€å¡Šå¯¬åº¦ */
  height: 0.8px;      /* å€å¡Šé«˜åº¦ */
 
   background: red;

  z-index: 3;         /* æ”¾åœ¨æ–‡å­—ä¸‹æ–¹ */
  pointer-events: none;
}


 .ruler {
    width: 100%;
    height: 100%;
    position: relative;
    /* 10cm = 35px, 50cm = 175px */
    background-image: repeating-linear-gradient(0deg, var(--ruler-color) 0 1px, transparent 0 35px), repeating-linear-gradient(0deg, var(--ruler-color) 0 2px, transparent 0 175px);
    background-size: 5px, 10px;
    background-repeat: no-repeat;
    background-position: right top;
    display: flex;
    flex-direction: column-reverse;
    justify-content: space-between;
    counter-reset: ruler-val -50;
 }
 /* æ•¸å­—æ¨™ç±¤ç¯€é» */

 .ruler div {
    counter-increment: ruler-val 50;
    position: relative;
    width: 100%;
    height: 0;
 }
 /* é¡¯ç¤ºæ•¸å­—æ–‡å­— */

 .ruler div::before {
    content: counter(ruler-val);
    position: absolute;
    right: 35px;
    bottom: -0.6em;
    font-size: 14px;
    color: var(--ruler-color);
    text-align: right;
    width: 30px;
 }
 /* è§’è‰²ä½ç½® */

 .character-container {
    position: absolute;
    bottom: 60px;
    display: flex;
    flex-direction: column;
    align-items: center;
    transform-origin: bottom center;
    transform: translateX(-50%) scale(1);
    transition: transform 0.1s ease;
    pointer-events: none;
 }
 .part {
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    background-color: rgba(189, 195, 199, 0.8);
    pointer-events: auto;
 }
 /*ä¸‹æ–¹é«˜åº¦æ¨™ç±¤*/

 .height-label {
    position: absolute;
    bottom: -35px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 2px 12px;
    border-radius: 10px;
    white-space: nowrap;
    pointer-events: none;
 }
 .section {
    margin-bottom: 15px;
    padding: 12px;
    background: #fafafa;
    border-radius: 8px;
    border: 1px solid #eee;
 }
 h4 {
    margin: 0 0 10px 0;
    border-left: 4px solid var(--primary);
    padding-left: 8px;
 }
 .row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
 }
 .row label {
    width: 15%;
    font-weight: bold;
 }
 input[type="range"] {
    flex: 1;
 }
 .val-text {
    width: 10%;
    color: var(--primary);
    text-align: right;
 }
 .percent-row {
    display: flex;
    height: 18px;
    border-radius: 9px;
    overflow: hidden;
    margin: 10px 0;
    background: #ddd;
    line-height: 18px;
    color: white;
    text-align: center;
 }
 /*=================================================== */

 /* æ²è»¸-Firefox */

 * {
    scrollbar-width: thin;
    scrollbar-color: #555 #222;
 }
 /* æ•¸å­—è¼¸å…¥æ¡† */

 input[type="number"], input[type="text"] {
    border: 0px;
    background-color: #2c3e50;
    color: #ecf0f1;
    padding: 0px 10px;
    border-radius: 4px;
    font-family: "Micro 5";
    font-size: 20px;
    width: 20px;
 }
 /* éš±è—è¼¸å…¥æ¡†ä¸Šä¸‹æŒ‰éˆ•Firefox */

 input[type=number] {
    -moz-appearance: textfield;
 }
 /* æ»‘æ¡¿æ¨£å¼ */

 input[type="range"] {
    width: 100%;
 }
 /* æ»‘æ¡¿è»Œé“-Firefox */

 input[type="range"]::-moz-range-track {
    background: #34495e;
    height: 6px;
    border-radius: 3px;
 }
 /* æ»‘æ¡¿æ§åˆ¶ç´ (åœ“é») - Firefox */

 input[type="range"]::-moz-range-thumb {
    background-color: #3498db;
    height: 14px;
    width: 14px;
    border-radius: 50%;
    border: 2px solid #ecf0f1;
    transition: transform 0.1s;
 }
 /* -æª”æ¡ˆä¸Šå‚³æŒ‰éˆ•æ¨£å¼ */

 input[type="file"]::file-selector-button {
    background-color: #34495e;
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    transition: background 0.3s;
    font-size: 12px;
    margin-right: 10px;
 }
 input[type="file"]::file-selector-button:hover {
    background-color: #2c3e50;
 }
 /* ç«ç‹å°ˆç”¨æª”æ¡ˆä¸Šå‚³æ¨£å¼ä¿®æ­£ */

 input[type="file"]::-moz-browse-button {
    background-color: #34495e;
    color: white;
    padding: 6px 12px;
    border-radius: 4px;
    border: none;
 }
 </style>
</head>

  <!-- ================================================ -->

<body>
   <div class="sidebar">
      <details open="">
         <summary>
            æ¯”ä¾‹å·¥å…·
         </summary>
         <div style="margin: 10px 0;">
            <div class="char-tabs" id="charTabs"></div><button class="a" onclick="addCharacter()">âœšæ–°å¢</button> <button class="d" onclick="deleteCharacter()">âœ–åˆªé™¤</button> <button class="r" onclick="resetCurrent()">â­¯é‡ç½®</button>
         </div>
         <div id="controls" style="display:none">
            <div class="section">
               <div class="row">
                  <label>ä½ç½®</label> <input id="posX" max="800" min="-800" oninput="updateCharBasic('posX', this.value)" type="range" value="0"> <span class="val-text" id="v-posX">0</span>
               </div>
            </div>
            <div class="section">
               <div class="row">
                  <label>ç¸½é«˜</label> <input id="totalH" max="300" min="10" oninput="updateTotalH(this.value)" type="range"> <input id="totalHNum" oninput="updateTotalH(this.value)" type="number">cm
               </div>
               <div class="row">
                  <label>å€å¡Š</label> <input id="visibleCount" max="5" min="1" oninput="updateVisibleCount(this.value)" type="range"> <span class="val-text" id="v-visible">5</span>
               </div>
               <div class="percent-row" id="percentBar"></div>
               <div id="heightSliders"></div>
            </div>
            <div class="section">
               <div id="widthSliders"></div>
            </div>
            <div class="section">
               <div id="imgUploads"></div>
            </div>
         </div>
      </details>
   </div>
<div class="horiz"></div>
   <div class="main-view">
      <div class="stage" id="stage">
         <!-- å°ºè¦(æ¯é–“éš”0, 50, 100, 150, 200) -->
         <div class="ruler-container" id="rulerContainer">

            <div class="ruler">
               <div></div>
               <div></div>
               <div></div>
               <div></div>
               <div></div>
            </div>
         </div>
      </div>
   </div>


  <!-- ================================================ -->

    <script>
      /* å®šç¾©å…¨åŸŸå¸¸æ•¸ï¼šéƒ¨ä½åç¨±ã€å¯¬åº¦åç¨±èˆ‡é è¨­é¡è‰² */
      const partNames = ["ğŸ„·", "ğŸ…ƒ", "ğŸ„°", "ğŸ„¿", "ğŸ„»"];
      const widthNames = ["ğŸ„·â–´", "ğŸ„·â–¾", "ğŸ…ƒâ–´", "ğŸ…ƒğŸ„°", "ğŸ„°ğŸ„¿", "ğŸ„¿ğŸ„»", "ğŸ„»â–¾"];
      const colors = ["#0D2744", "#53728A", "#7691AD", "#B9CFDD", "#FF929A"];
      // ä¿®æ­£æ¯”ä¾‹å¸¸æ•¸ï¼š200cm å°æ‡‰ 700px é«˜åº¦
      const SCALE_BASE = 3.5;
      /* åˆå§‹åŒ–å–®ä¸€è§’è‰²çš„é è¨­æ•¸æ“šçµæ§‹ */
      function createDefaultChar(name) {
         return {
            name: name,
            posX: 0,
            visible: 5,
            heights: [25, 25, 20, 20, 90], // å„éƒ¨ä½é«˜åº¦ (æ¯”ä¾‹å–®ä½)
            widths: [25, 25, 45, 40, 30, 40, 20],
            imgs: [null, null, null, null, null]
         };
      }
      /* è§’è‰²æ¸…å–®èˆ‡ç•¶å‰é¸ä¸­è§’è‰²çš„ç´¢å¼• */
      let characters = [createDefaultChar("1")];
      let activeIdx = 0;
      /* è¨ˆç®—ç•¶å‰è§’è‰²ã€Œå¯è¦‹éƒ¨ä½ã€çš„ç¸½é«˜åº¦ */
      function getVisibleHeight(c) {
         return c.heights.slice(0, c.visible).reduce((a, b) => a + b, 0);
      }
      /* ç¨‹å¼å…¥å£ï¼šåˆå§‹åŒ– UI ä¸¦æ¸²æŸ“ç•«é¢ */
      function init() {
         renderTabs();
         loadControls();
         renderStage();
      }
      /* æ¸²æŸ“ä¸Šæ–¹çš„è§’è‰²åˆ‡æ›æ¨™ç±¤ */
      function renderTabs() {
         const container = document.getElementById('charTabs');
         container.innerHTML = characters.map((c, i) => `
                <div class="tab ${i === activeIdx ? 'active' : ''}" onclick="switchChar(${i})">${c.name}</div>
            `).join('');
      }
      /* åˆ‡æ›è§’è‰²æ™‚é‡æ–°è¼‰å…¥å°æ‡‰çš„æ§åˆ¶é …èˆ‡é è¦½ */
      function switchChar(idx) {
         activeIdx = idx;
         init();
      }
      /* æ–°å¢è§’è‰²ä¸¦è¨­å®šåˆå§‹åç§»ä½ç½® */
      function addCharacter() {
         const newChar = createDefaultChar("" + (characters.length + 1));
         newChar.posX = (characters.length) * 80; // æ–°è§’è‰²å¾€å³åç§»
         characters.push(newChar);
         activeIdx = characters.length - 1;
         init();
      }
      /* åˆªé™¤ç•¶å‰è§’è‰² (è‡³å°‘ä¿ç•™ä¸€å€‹) */
      function deleteCharacter() {
         if (characters.length <= 1) return;
         characters.splice(activeIdx, 1);
         activeIdx = 0;
         init();
      }
      /* è¼‰å…¥ç•¶å‰è§’è‰²çš„æ•¸å€¼åˆ°å·¦æ§åˆ¶é¢æ¿ (æ‹‰æ¡¿ã€æ•¸å­—è¼¸å…¥æ¡†ã€åœ–ç‰‡ä¸Šå‚³å™¨) */
      function loadControls() {
         const c = characters[activeIdx];
         const visH = getVisibleHeight(c);
         document.getElementById('controls').style.display = 'block';
         document.getElementById('posX').value = c.posX;
         document.getElementById('v-posX').innerText = c.posX;
         document.getElementById('totalH').value = visH;
         document.getElementById('totalHNum').value = Math.round(visH);
         document.getElementById('visibleCount').value = c.visible;
         document.getElementById('v-visible').innerText = c.visible;
         /* å‹•æ…‹ç”Ÿæˆé«˜åº¦èª¿æ•´æ‹‰æ¡¿ */
         const hDiv = document.getElementById('heightSliders');
         hDiv.innerHTML = c.heights.map((h, i) => `
                <div class="row" style="display: ${i < c.visible ? 'flex' : 'none'}">
                    <label>${partNames[i]}</label>
                    <input type="range" min="5" max="150" step="0.1" value="${h}" class="h-slider" oninput="adjustPartHeight(${i}, this.value)">
                    <span class="val-text">${Math.round(h)}</span>
                </div>
            `).join('');
         /* å‹•æ…‹ç”Ÿæˆå¯¬åº¦èª¿æ•´æ‹‰æ¡¿ (æ ¹æ“šå¯è¦‹éƒ¨ä½æ•¸é‡é€£å‹•é¡¯ç¤º) */
         const wDiv = document.getElementById('widthSliders');
         wDiv.innerHTML = c.widths.map((w, i) => {
            let show = (i <= 1 && c.visible >= 1) || (i <= 3 && c.visible >= 2) || (i === 4 && c.visible >= 3) || (i === 5 && c.visible >= 4) || (i === 6 && c.visible >= 5);
            return `
                    <div class="row" style="display: ${show ? 'flex' : 'none'}">
                        <label>${widthNames[i]}</label>
                        <input type="range" min="5" max="150" value="${w}" class="w-slider" oninput="updateCharWidth(${i}, this.value)">
                        <span class="val-text">${w}</span>
                    </div>
                `;
         }).join('');
         /* å‹•æ…‹ç”Ÿæˆåœ–ç‰‡ä¸Šå‚³æŒ‰éˆ• */
         const iDiv = document.getElementById('imgUploads');
         iDiv.innerHTML = partNames.map((name, i) => `
                <div class="row" style="display: ${i < c.visible ? 'flex' : 'none'}">
                    <label>${name}</label><input type="file" style="font-size:10px" onchange="uploadImg(event, ${i})">
                </div>
            `).join('');
         updatePercentBar();
      }
      /* åŒæ­¥è³‡æ–™èˆ‡ UI ä¸Šçš„æ‹‰æ¡¿æ•¸å€¼ (ç”¨æ–¼é«˜åº¦èª¿æ•´å¾Œç¶­æŒ UI ä¸€è‡´) */
      function syncUISliders() {
         const c = characters[activeIdx];
         const visH = getVisibleHeight(c);
         const hSliders = document.querySelectorAll('.h-slider');
         const hTexts = document.querySelector('#heightSliders').querySelectorAll('.val-text');
         c.heights.forEach((h, i) => {
            if (hSliders[i]) hSliders[i].value = h;
            if (hTexts[i]) hTexts[i].innerText = Math.round(h);
         });
         document.getElementById('totalH').value = visH;
         document.getElementById('totalHNum').value = Math.round(visH);
         updatePercentBar();
      }
      /* æ›´æ–°åŸºæœ¬æ•¸å€¼ (ä¾‹å¦‚ï¼šå·¦å³åç§») */
      function updateCharBasic(key, val) {
         characters[activeIdx][key] = parseInt(val);
         document.getElementById('v-' + key).innerText = val;
         renderStage();
      }
      /* æ›´æ–°é¡¯ç¤ºéƒ¨ä½çš„æ•¸é‡ (ç”±é ­éƒ¨å¾€ä¸‹éå¢) */
      function updateVisibleCount(val) {
         characters[activeIdx].visible = parseInt(val);
         loadControls();
         renderStage();
      }
      /* èª¿æ•´å–®ä¸€éƒ¨ä½é«˜åº¦ï¼Œä¸¦ã€Œè£œå„Ÿã€å…¶ä»–éƒ¨ä½ä»¥ç¶­æŒç¸½é«˜åº¦ä¸è®Š */
      function adjustPartHeight(idx, newVal) {
         newVal = parseFloat(newVal);
         const c = characters[activeIdx];
         const targetTotalH = getVisibleHeight(c);
         if (newVal < 5) newVal = 5;
         if (newVal > targetTotalH - (c.visible - 1) * 5) {
            newVal = targetTotalH - (c.visible - 1) * 5;
         }
         const oldVal = c.heights[idx];
         const delta = newVal - oldVal;
         const otherIndices = [];
         for (let i = 0; i < c.visible; i++) {
            if (i !== idx) otherIndices.push(i);
         }
         if (otherIndices.length > 0) {
            c.heights[idx] = newVal;
            const otherSum = otherIndices.reduce((sum, i) => sum + c.heights[i], 0);
            let remainingDelta = delta;
            otherIndices.forEach((oi, i) => {
               const ratio = otherSum > 0 ? c.heights[oi] / otherSum : 1 / otherIndices.length;
               const deduction = delta * ratio;
               c.heights[oi] -= deduction;
               if (c.heights[oi] < 5) {
                  const deficit = 5 - c.heights[oi];
                  c.heights[oi] = 5;
               }
            });
            const currentTotal = getVisibleHeight(c);
            const finalError = targetTotalH - currentTotal;
            c.heights[otherIndices[otherIndices.length - 1]] += finalError;
         }
         syncUISliders();
         renderStage();
      }
      /* æ•´é«”ç¸®æ”¾ï¼šæ ¹æ“šç›®æ¨™ç¸½é«˜åº¦ï¼ŒæŒ‰æ¯”ä¾‹ç¸®æ”¾æ‰€æœ‰å¯è¦‹éƒ¨ä½ */
      function updateTotalH(val) {
         if (!val || val < 1) return;
         val = parseFloat(val);
         const c = characters[activeIdx];
         const currentVisH = getVisibleHeight(c);
         const ratio = val / currentVisH;
         for (let i = 0; i < c.visible; i++) c.heights[i] *= ratio;
         syncUISliders();
         renderStage();
      }
      /* æ›´æ–°ç‰¹å®šæ¥é»çš„å¯¬åº¦æ•¸æ“š */
      function updateCharWidth(i, val) {
         characters[activeIdx].widths[i] = parseInt(val);
         const wTexts = document.querySelector('#widthSliders').querySelectorAll('.val-text');
         if (wTexts[i]) wTexts[i].innerText = val;
         renderStage();
      }
      /* æ›´æ–° UI ä¸‹æ–¹çš„å½©è‰²æ¯”ä¾‹æ¢ (é¡¯ç¤ºå„éƒ¨ä½ç™¾åˆ†æ¯”) */
      function updatePercentBar() {
         const c = characters[activeIdx];
         const bar = document.getElementById('percentBar');
         const visH = getVisibleHeight(c);
         bar.innerHTML = c.heights.slice(0, c.visible).map((h, i) => {
            const p = (h / visH * 100).toFixed(0);
            return `<div style="width:${p}%; background:${colors[i]}">${p}%</div>`;
         }).join('');
      }
      /* è™•ç†åœ–ç‰‡ä¸Šå‚³ï¼Œè½‰æ›ç‚º DataURL ä¸¦å­˜å…¥è§’è‰²æ•¸æ“š */
      function uploadImg(e, partIdx) {
         const file = e.target.files[0];
         if (file) {
            const reader = new FileReader();
            reader.onload = (ev) => {
               characters[activeIdx].imgs[partIdx] = ev.target.result;
               renderStage();
            };
            reader.readAsDataURL(file);
         }
      }
      /* ç¹ªåœ–å¼•æ“ï¼šæ ¹æ“šæ•¸æ“šå‹•æ…‹ç”ŸæˆHTMLå…ƒç´ èˆ‡clip-path(æ¢¯å½¢æ•ˆæœ) */
      function renderStage() {
         const stage = document.getElementById('stage');
         let maxDisplayH = 0;
         /* æ¸…ç†ç¾æœ‰è§’è‰²å®¹å™¨ä¸¦ä¿ç•™æ¨™å°ºèƒŒæ™¯ */
         const containers = stage.querySelectorAll('.character-container');
         containers.forEach(el => el.remove());
         /* éæ­·æ‰€æœ‰è§’è‰²é€²è¡Œç¹ªè£½ */
         characters.forEach((c, charIdx) => {
            const charDiv = document.createElement('div');
            charDiv.className = 'character-container';  // è¨­ç½®ä½ç§»
            charDiv.style.left = `calc(50% + ${c.posX}px)`;
            charDiv.style.zIndex = charIdx;
            let charH = 0;
            for (let i = 0; i < c.visible; i++) {
               const part = document.createElement('div');
               part.className = 'part';
               /* æ±ºå®šéƒ¨ä½çš„é ‚éƒ¨èˆ‡åº•éƒ¨å¯¬åº¦ */
               let tw = (i === 0) ? c.widths[0] : c.widths[i + 1];
               let bw = (i === 0) ? c.widths[1] : c.widths[i + 2];
               const maxW = Math.max(tw, bw);
               const hPx = c.heights[i] * SCALE_BASE;
               part.style.width = (maxW * SCALE_BASE) + 'px';
               part.style.height = hPx + 'px';
               /* è¨­ç½®èƒŒæ™¯åœ–æˆ–ç´”è‰² */
               if (c.imgs[i]) {
                  part.style.background = `url(${c.imgs[i]}) no-repeat center/cover transparent`;
               } else {
                  part.style.background = `${colors[i]}`;
               }
               /* ä½¿ç”¨ clip-path å‰ªè£å‡ºæ¢¯å½¢å½¢ç‹€ */
               const tP = ((maxW - tw) / 2 / maxW) * 100;
               const bP = ((maxW - bw) / 2 / maxW) * 100;
               part.style.clipPath = `polygon(${tP}% 0%, ${100-tP}% 0%, ${100-bP}% 100%, ${bP}% 100%)`;
               charDiv.appendChild(part);
               charH += hPx;
            }
            /* é¡¯ç¤ºèº«é«˜æ¨™ç±¤ */
            const label = document.createElement('div');
            label.className = 'height-label';
            label.innerText = `${Math.round(getVisibleHeight(c))} cm`;
            charDiv.appendChild(label);
            if (charH > maxDisplayH) maxDisplayH = charH;
            stage.appendChild(charDiv);
         });
         /* è‡ªå‹•ç¸®æ”¾ï¼šå¦‚æœè§’è‰²è¶…å‡ºè¦–çª—é«˜åº¦ï¼Œæ•´é«”ç¸®æ”¾ä»¥ç¬¦åˆå®¹å™¨ */
         const stageH = stage.clientHeight - 120;
         const scale = maxDisplayH > stageH ? stageH / maxDisplayH : 1;
         document.querySelectorAll('.character-container').forEach(el => {
            el.style.transform = `translateX(-50%) scale(${scale})`;
         });
         document.getElementById('rulerContainer').style.transform = `scale(${scale})`;
      }
      /* å°‡ç•¶å‰è§’è‰²æ•¸æ“šé‡è¨­ç‚ºåˆå§‹å€¼ */
      function resetCurrent() {
         const name = characters[activeIdx].name;
         characters[activeIdx] = createDefaultChar(name);
         init();
      }
      /* è¦–çª—å¤§å°æ”¹è®Šæ™‚é‡æ–°æ¸²æŸ“é è¦½ */
      window.onresize = renderStage;
      /* å•Ÿå‹•ç¨‹å¼ */
      init();
    </script>
</body>
</html>
